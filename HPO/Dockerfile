FROM rapidsai/rapidsai:0.9-cuda10.0-runtime-ubuntu18.04

RUN apt update && apt -y upgrade
# Fix font-manager package
RUN apt-get update && \
    apt-get install -y --fix-missing font-manager && \
    rm -rf /var/lib/apt/lists/*

RUN source activate rapids && conda install -y -c conda-forge ipywidgets
RUN source activate rapids && jupyter labextension install @jupyter-widgets/jupyterlab-manager

RUN source activate rapids && conda install -y -c conda-forge ipyvolume
RUN source activate rapids && jupyter labextension install ipyvolume

RUN source activate rapids && conda install -c conda-forge python-graphviz

RUN source activate rapids && conda install -y -c rapidsai cupy

RUN source activate rapids && pip install git+https://github.com/dask/dask-kubernetes.git

RUN source activate rapids && mkdir /rapids-dask-hpo && cd /rapids-dask-hpo && git clone https://github.com/miroenev/rapids && cd rapids/HPO/ && python setup.py install

EXPOSE 8888

WORKDIR /
